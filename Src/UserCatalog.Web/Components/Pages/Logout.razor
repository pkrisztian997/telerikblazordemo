@page "/logout"
@inject HttpClient Http
@inject NavigationManager Nav
@inject IJSRuntime JS

<PageTitle>Log out</PageTitle>

@code {
    protected override async Task OnInitializedAsync()
    {
        await Http.PostAsync("/api/user/logout", null);
        
        await JS.InvokeVoidAsync("eval", @"
            document.cookie.split(';').forEach(function(c) {
                document.cookie = c.replace(/^ +/, '')
                                   .replace(/=.*/, '=;expires=' + new Date().toUTCString() + ';path=/');
            });
        ");

        Nav.NavigateTo("/login", forceLoad: true);
    }
}
